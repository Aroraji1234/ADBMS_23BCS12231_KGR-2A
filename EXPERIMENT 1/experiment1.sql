--------------------------- EASY---------------------------
--Author-Book Relationship Using Joins and Basic SQL Operations

CREATE TABLE TBL_AUTHOR_DETAILS(
	AUTHOR_ID INT PRIMARY KEY,
	AUTHOR_NAME VARCHAR(50),
	COUNTRY VARCHAR(50)
);

CREATE TABLE TBL_BOOK_DETAILS(
	BOOK_ID INT PRIMARY KEY,
	BOOK_TITLE VARCHAR(MAX),
	AUTHORID INT  
	FOREIGN KEY (AUTHORID) REFERENCES TBL_AUTHOR_DETAILS(AUTHOR_ID)
);

INSERT INTO TBL_AUTHOR_DETAILS VALUES (1,'PIYUSH','INDIA');
INSERT INTO TBL_AUTHOR_DETAILS VALUES (2,'YASH','USA');
INSERT INTO TBL_AUTHOR_DETAILS VALUES (3,'SUKHMANDEEP','CHINA');
SELECT * FROM TBL_AUTHOR_DETAILS;

INSERT INTO TBL_BOOK_DETAILS VALUES (1,'JAVA HANDS ON',1);
INSERT INTO TBL_BOOK_DETAILS VALUES (2,'FB MARKETPLACE',2);
INSERT INTO TBL_BOOK_DETAILS VALUES (3,'MOON DANCE',3);
SELECT * FROM TBL_BOOK_DETAILS;

SELECT BD.BOOK_TITLE, AD.AUTHOR_NAME, AD.COUNTRY
FROM
TBL_AUTHOR_DETAILS AS AD
INNER JOIN 
TBL_BOOK_DETAILS AS BD
ON
AD.AUTHOR_ID = BD.AUTHORID ;

------------------------- MEDIUM ----------------------
--Department-Course Subquery and Access Control

CREATE TABLE TBL_DEPARTMENTS (
DEPT_ID INT PRIMARY KEY,
DEPT_NAME VARCHAR(100) NOT NULL
);

CREATE TABLE TBL_COURSES (
COURSE_ID INT PRIMARY KEY,
COURSE_NAME VARCHAR(150) NOT NULL,
DEPT_ID INT,
FOREIGN KEY (DEPT_ID) REFERENCES TBL_DEPARTMENTS(DEPT_ID)
);

INSERT INTO TBL_DEPARTMENTS VALUES
(1, 'PIYUSH'),
(2, 'YASH'),
(3, 'SUKHMANDEEP'),
(4, 'KARAN'),
(5, 'ATUL');
SELECT * FROM TBL_DEPARTMENTS;

INSERT INTO TBL_COURSES VALUES
(101, 'Data Structures', 1),
(102, 'Operating Systems', 1),
(103, 'Algorithms', 1),
(104, 'Calculus I', 2),
(105, 'Linear Algebra', 2),
(106, 'Quantum Mechanics', 3),
(107, 'Classical Mechanics', 3),
(108, 'Modern Poetry', 4),
(109, 'Cell Biology', 5),
(110, 'Genetics', 5);
SELECT * FROM TBL_COURSES;

SELECT DEPT_NAME
FROM TBL_DEPARTMENTS
WHERE DEPT_ID IN (
SELECT DEPT_ID
FROM TBL_COURSES
GROUP BY DEPT_ID
HAVING COUNT(COURSE_ID) > 2
);
